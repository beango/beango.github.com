<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>利用Jekyll搭建个人博客</title>
  <meta name="description" content="Jekyll是一个静态网站生成器，用ruby编写而成，结合了markdown、Liquid等技术，简化了静态网站的构建过程，配合disqus等技术，可以方便的生成具有简单动态功能的网站。">

  <link rel="canonical" href="127.0.0.1/archives/2012/07/25/jekyll-introduction.html">

  <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
  <!-- <link rel="stylesheet" href="/assets/css/icard_resume.css"> -->
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <link rel="stylesheet" href="/assets/css/blog.css" >
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- <link rel="stylesheet" href="/assets/css/prettify.css" /> --> <!-- 设置代码主题，此文件为默认主题，你可以换成其他主题-->
  <!-- <script src="/assets/css/prettify.js" type="text/javascript"></script> -->
  <link rel="icon" type="image/png" href="/assets/img/avatar.png">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="assets/js/html5shiv.min.js"></script>
  <script src="assets/js/respond.min.js"></script>
  <![endif]-->

</head>

    <body>
        <header class="bloghead">
    <dev class="authorheader">
        <a href="/">
            <img alt="My Avatar" src="/assets/img/avatar.png"/>
        </a>
        <dev class="blogtitle">
            <h1><a href="/">HuangDing</a></h1>
            <h5> 自己选的路，跪着也走下去! </h5>
        </dev>
    </dev>

    <nav class="menu" role="nav">
        <ul>
            <li><a href="/">Home</a></li>
            <li>|</li>
            <li><a href="/menu.html">Menu</a></li>
            <li>|</li>
            <li><a href="/collection.html">Collection</a></li>
            <li>|</li>
            <li><a target="_blank" href="https://github.com/beango">Github</a></li>
            <li>|</li>
            <li><a target="_blank" href="/about.html">About Me</a></li>
        </ul>
    </nav>
</header>


        <main class="blogmain">
            <header>
                <h1 class="article-title">利用Jekyll搭建个人博客</h1>
                <p class="article-time">
                    ,  发表于 <span></span>
                </p>
                <p class="article-hint">
                    如果你对本文有任何的建议或者疑问, 可以在
                    <a href="https://github.com/liungkejin/liungkejin.github.io/issues" target="_blank">这里给我提 Issues</a>, 谢谢! :)
                </p>
            </header>
            <p>Jekyll是一个静态网站生成器，用ruby编写而成，结合了markdown、Liquid等技术，简化了静态网站的构建过程，配合disqus等技术，可以方便的生成具有简单动态功能的网站。</p>

<h3 id="section">准备工作</h3>

<ul>
  <li>安装<a href="http://rubyinstaller.org/downloads/">RubyInstaller</a>（笔者１.９.３版本）</li>
  <li>安装<a href="http://rubyinstaller.org/downloads/">DevKit</a>（Ruby 1.8.6 to 1.9.3使用 tdm-32-4.5.2）</li>
  <li>
    <p>在DevKit目录找到msys.bat运行并安装Jekyll和rdiscount：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ gem install jekyll -v 0.11.2  
$ gem install rdiscount -v 1.6.8
</code></pre>
    </div>
  </li>
  <li>安装<a href="http://www.python.org/getit/">Python</a>（推荐Python 2.7.2）</li>
  <li>安装Python <a href="http://pypi.python.org/pypi/setuptools">setuptools</a>，找对应的exe文件下载安装。</li>
  <li>添加 C:\Python27\Scripts（假设你的Python安装在C盘根目录下）到你的path</li>
  <li>
    <p>转到Python27\Scripts目录下安装pygments:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ easy_install pygments
</code></pre>
    </div>
  </li>
  <li>安装windows下的Git——<a href="http://msysgit.github.com/">msysGit</a></li>
  <li>在Github上创建一个账户。Github会引导你如何进行简单的设置，如果你没用过Git，没关系，只管照做。</li>
</ul>

<h3 id="jekyll-blog">3分钟搭建Jekyll Blog</h3>

<ul>
  <li>
    <p>创建一个新的个版本库</p>

    <p>登陆你的<a href="https://github.com/">Github</a>账户，创建一个新的版本库，命名为USERNAME.github.com</p>
  </li>
  <li>
    <p>安装Jekyll引导程序（Jekyll-Bootstrap）</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ git clone https://github.com/plusjade/jekyll-bootstrap.git USERNAME.github.com  
$ cd USERNAME.github.com  
$ git remote set-url origin git@github.com:USERNAME/USERNAME.github.com.git  
$ git push origin master
</code></pre>
    </div>
  </li>
  <li>
    <p>enjoy<br />
两分钟后你的Blog神奇的出现在<a href="http://username.github.com/">http://USERNAME.github.com</a></p>
  </li>
  <li>
    <p>如果你安装了Jekyll，你可以在本地预览你的Blog:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ git clone https://github.com/plusjade/jekyll-bootstrap.git  
$ cd jekyll-bootstrap  
$ jekyll --server
</code></pre>
    </div>
  </li>
</ul>

<p>　　在浏览器预览<a href="http://localhost:4000/">http://localhost:4000</a>.</p>

<ul>
  <li><a href="http://jekyllbootstrap.com/lessons/jekyll-introduction.html">更多介绍</a></li>
</ul>

<h3 id="git-ssh">创建git ssh</h3>

<ul>
  <li>
    <p>查看是否已经有了ssh密钥：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>cd ~/.ssh
</code></pre>
    </div>
  </li>
  <li>
    <p>生存密钥：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ ssh-keygen -t rsa -C "...@gmail.com"
</code></pre>
    </div>

    <p>按3个回车，密码为空。</p>

    <blockquote>
      <p>Your identification has been saved in /home/tekkub/.ssh/id_rsa.<br />
Your public key has been saved in /home/tekkub/.ssh/id_rsa.pub.<br />
The key fingerprint is:
………………</p>
    </blockquote>

    <p>最后得到了两个文件：id_rsa和id_rsa.pub</p>
  </li>
  <li>
    <p>添加密钥到ssh：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>ssh-add 文件名
</code></pre>
    </div>

    <p>如果出错（Could not open a connection to your authentication agent），执行：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>ssh-agent bash
</code></pre>
    </div>
  </li>
  <li>
    <p>将“id_rsa.pub”里面的公钥添加到github.com</p>
  </li>
  <li>
    <p>注意要将项目的连接地址改为ＳＳＨ连接</p>
  </li>
</ul>

<h3 id="section-1">快速开始</h3>

<ul>
  <li>
    <p>本地运行Jekyll</p>

    <p>假设你已经安装好了jekyll-bootstrap，以及其他一些基本运行环境和工具，首先启动你本地的WEBrick服务器（Ruby自带的）：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ cd USERNAME.github.com  
$ jekyll --server  
</code></pre>
    </div>

    <p>别忘了把USERNAME换成你的GitHub用户名。<br />
你的Blog在这预览: <a href="http://localhost:4000/">http://localhost:4000/</a>。</p>
  </li>
  <li>
    <p>创建第一篇博文</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ rake post title="Hello World"
</code></pre>
    </div>

    <p>情况下rake命令会在你的_posts目录下创建一个名为[年-月-日-posttitle.md]的文件，例如2012-05-04-Hello-World.md，名称中的空格会转换成“-”，时间为当前系统时间。当然这些都是可配置的。<br />
rake命令默认不会覆盖掉相同名称的文件。</p>
  </li>
  <li>
    <p>创建第一个页面</p>

    <div class="highlighter-rouge"><pre class="highlight"><code># 根目录下创建页面  
$ rake page name="about.md"

# 自定义目录下创建页面  
$ rake page name="pages/about.md"

# 创建类似./pages/about/index.html目录结构的页面  
$ rake page name="pages/about"
</code></pre>
    </div>

    <p>发布</p>
  </li>
  <li>
    <p>完成一篇博文或者做一些修改之后可以用简单的git命令提交到远程的Github版本库。同时Github可以将md文件解析成html文件，通过USERNAME.github.com就可以访问刚才提交的博文。</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ git add .  
$ git commit -m "Add new content"  
$ git push origin master
</code></pre>
    </div>

    <p>至此你就可以写自己的blog like a hacker。</p>

    <p>当然你还可以运用一些预置的主题，做一些自定义的配置，以及自己定义主题增加模板配置文件、增加Blog挂件、加入Google Analytics、Disqus等等，同样可以将一个静态网站做的栩栩如生。</p>
  </li>
  <li>
    <p>另外网站默认是托管在Github服务器（实际上是RackSpace的云服务器）上的，你还可以考虑免费的Heroku，至于GAE、EC2（免费一年），显然有些大材小用了。</p>
  </li>
</ul>

<h3 id="section-2">遇到的问题</h3>

<ul>
  <li>
    <p>本地post中出现中文不能正常编译</p>

    <p>由于windows下的git控制台MinGW默认不支持中文编码，需要将其设置为UTF-8，有两种解决方案：<br />
临时：控制台输入以下语句</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ export LC_ALL=en_US.UTF-8  
$ export LANG=en_US.UTF-8  
</code></pre>
    </div>

    <p>永久：添加两个用户自定义的环境变量，LC_ALL=en_US.UTF-8 和 LANG=en_US.UTF-8（你想的没错，就是修改windows环境变量）</p>

    <p>也可以找到你的Ruby安装目录，如：D:\Ruby193, 在里面找到文件D:\Ruby193\lib\ruby\gems\1.9.1\gems\jekyll-0.12.0\lib\jekyll\convertible.rb 在该文件中找到下面句子：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code># Returns nothing.
def read_yaml(base, name)
  self.content = File.read(File.join(base, name))
</code></pre>
    </div>

    <p>将它修改为：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code># Returns nothing.
def read_yaml(base, name)
  self.content = File.read(File.join(base, name),:encoding=&gt;"utf-8")
</code></pre>
    </div>

    <p>另外Jekyll默认的Markdown引擎markup对中文的解析不是很好，建议换成rdiscount。在_config.yml文件中pygments: true上一行添加markdown: rdiscount。在此之前你必须首先安装Rdiscount。</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ gem install rdiscount
</code></pre>
    </div>
  </li>
  <li>
    <p>Liquid error: No such file or directory - pygmentize</p>

    <p>没有安装Pygments的缘故，如果你安装了python，只需要easy install。</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ easy_install Pygments
</code></pre>
    </div>
  </li>
  <li>
    <p>Liquid error: bad file descriptor</p>

    <p>我的电脑上同时装了python2.7和python3.2，我想是这个原因。需要给albino.rb文件打个补丁，假设你的Ruby安装在D:\Program\，并且你已经把<a href="https://gist.github.com/2592525">albino-windows-refactor.patch</a>补丁文件copy到了下边的目录：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$ cd D:\Program\Ruby193\lib\ruby\gems\1.9.1\gems\albino-1.3.3\lib  
$ patch &lt; albino-windows-refactor.patch
</code></pre>
    </div>
  </li>
  <li>
    <p>侧边栏二级目录的链接不起作用</p>

    <p>这个问题花了不少时间，最终还是未能找到问题所在，无奈，只有自己动手丰衣足食，自己写js搞定。</p>

    <p>首先看一下源码，在assets\app.js文件中的Toc中看可以看到：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>node.children.each(function(){  
    cache += '&lt;li class="sub"&gt;&lt;a href="#'+ this.id + '"&gt;'+ $(this).text() + '&lt;/a&gt;&lt;/li&gt;';  
})  
</code></pre>
    </div>

    <p>显然他在这为链接设置了href，但是调用了h2对象（也就是侧边栏目录的二级菜单）的id属性，而用Firebug查看最终解析成的html文件，发现&lt;h2&gt;的id是不存在的，于是自然想到这在之前先为h2设置唯一的id属性。这个用jQuery很容易就能实现：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>$("h2").each(function(){$(this).attr("id","_"+$(this).text());});
</code></pre>
    </div>
  </li>
  <li>
    <p>类似于could’t parse YAML at line 6 column 6 (Psych::SyntaxError)的问题<br />
YAM了貌似对空格比较敏感，需要一个空格的时候就不要敲多个空格，同时注意你的Tab缩进，_config.yml中的属性都是key: value形式的，别忘了：后边有个空格。</p>

    <p>另外post文件头中的属性配置也要注意：</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="gd">---  
</span>layout: post  
title : post_title  
categories : category_name  
description: |  
    This is a decription.  
<span class="gd">---  
</span></code></pre>
    </div>

    <p>description第二行开头我敲了一个Tab（四个字符宽度）就出错了，一些细节，注意一下就好了。</p>
  </li>
</ul>

<h3 id="section-3">域名绑定</h3>

<p>Github会为你分配一个类似于USERNAME.github.com的二级域名，如果你自己有一个顶级域名，你可以将它与Github提供的一个共有IP(204.232.175.78)绑定，这个在Github Pages上有详细介绍，在你的网站根目录下增加一个CNAME文件，里边写你自己的域名，再给你的域名增加一条A记录，稍等片刻之后就可以用你的域名访问了。</p>

<p>当然域名是需要花钱的，如果你舍不得花银子，免费的午餐还是会有的，你可以免费申请一个（当然也可以是多个）.tk的域名。DotTK提供yourname.tk的免费顶级域名。.tk是南太平洋岛国托克劳的国家域名，免费注册一个帐户可以任意申请.tk域名，支持域名转发（可隐藏原URL）、电邮转发、A记录解析、CNAME别名记录、MX邮件记录、设置DNS服务器等服务。当然免费的总是会有一些限制条件喽。</p>

<p>如果你注册的域名在90天内访问量少于25个，你的域名将被删除！<br />
如果你开通的电邮转发在90天内收到的邮件少于10封，你的电邮转发服务将被停止！
另外很多看起来不错的域名不是免费的，要交费才能注册使用！比如说cn.tk。</p>

<p>注册流程很简单，有中文版的，几十秒钟你的免费顶级域名就到手了，是不是很happy！</p>

<h3 id="section-4">其他</h3>

<ul>
  <li>html代码转markdown <a href="http://johnmacfarlane.net/pandoc/installing.html">pandoc</a>:<br />
pandoc -f html -t markdown hello.html -o 2012-08-06-hello.md</li>
  <li><a href="http://www.cnblogs.com/rollenholt/articles/2389459.html">github中的登录认证</a></li>
</ul>

            <footer class="article-footer">
    <div class="authorimage">
        <img src="/assets/img/avatar.png" alt="My Avatar" class="img-circle">
    </div>
    <section class="author">
        <h4><a href="/about.html">黃丁</a></h4>
        <a href="mailto:6588617@gmail.com">6588617@gmail.com</a>
    </section>
</footer>

        </main>

        <div class="footer-copyright">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="col-md-12">
                Copyright &copy; 2016 黃丁 - All rights reserved.
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="/assets/js/jquery.min.js"></script>
<script type="text/javascript" src="/assets/js/bootstrap.min.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74743250-2', 'auto');
  ga('send', 'pageview');

</script>


    </body>

</html>
